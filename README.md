#Домашнее задание
Работа с mdadm  
Цель: В результате выполнения ДЗ студент изменит Vagrantfile, создаст скрипт для создания рейда, конф для автосборки рейда при загрузке. Студент получил навыки работы с Vagrantfile.  
добавить в Vagrantfile еще дисков  
сломать/починить raid  
собрать R0/R5/R10 на выбор  
прописать собранный рейд в конф, чтобы рейд собирался при загрузке  
создать GPT раздел и 5 партиций  
  
в качестве проверки принимаются - измененный Vagrantfile, скрипт для создания рейда, конф для автосборки рейда при загрузке  
* доп. задание - Vagrantfile, который сразу собирает систему с подключенным рейдом  
** перенесети работающую систему с одним диском на RAID 1. Даунтайм на загрузку с нового диска предполагается. В качестве проверики принимается вывод команды lsblk до и после и описание хода решения (можно воспользовать утилитой Script).  


# Решение  
Добавляем в Vagrantfile ещё два диска в соответствующий раздел:
```ruby
vi ./Vagrantfile  
MACHINES = {  
:otuslinux => {  
        :disks => {  
                    :sata5 => {    
                            :dfile => './sata5.vdi',    
                            :size => 250, # Megabytes  
                            :port => 5  
                          },  
                    :sata6 => {    
                            :dfile => './sata6.vdi',    
                            :size => 250, # Megabytes   
                            :port => 6  
                          }  
                  }  
              },  
           }    
```                
далее написан скрипт для запуска внутри системы на создание,разметку и монтирование raid6 на 6 дисках, в директорию /mnt  
```bash
mdadm --create --verbose /dev/md0 --level=6 --raid-devices=5 /dev/sd{b..f} 
mkfs.xfs /dev/md0 -f &&  
echo $(blkid|grep md0|awk '{print $2 " /mnt xfs defaults 0 0" }') >> /etc/fstab   
mount -a  
```
имитируем падение диска  
```
mdadm --fail /dev/md0 /dev/sdb  
```
удаляем его из массива  
```
mdadm --remove /dev/md0 /dev/sdb  
```
добавляем в массив новый диск  
```
mdadm --add /dev/md0 /dev/sdg  
```
далее диск определиться в массиве и пойдёт ребилдинг диска,
процесс ребилдинга в интерактивном режиме можно посмотреть следующей командой
```
watch cat /proc/mdstat  
```
[Vagrantfile с собранным raid6 на 6 дисках]()
